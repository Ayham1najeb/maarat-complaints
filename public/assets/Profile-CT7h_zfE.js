import{c as _,a as E,o as $,u as z,r,p as u,z as o,j as e,b as I,C as M,k as C,X as R}from"./index-Ep9RS7kH.js";import{S as q}from"./save-Cg_vMeVj.js";import{F as H,T as J}from"./trending-up-D5KHsi1h.js";import{C as O}from"./clock-BCADffly.js";import{C as B}from"./circle-check-big-BSwdeQ4j.js";const V=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],X=_("camera",V);const G=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],K=_("pen",G),ae=()=>{const{user:t,setUser:w}=E(),j=$(),S=z(),[d,k]=r.useState(null),[A,P]=r.useState(!0),[i,h]=r.useState("profile"),[x,p]=r.useState(!1),[n,c]=r.useState({name:"",email:"",phone:""}),[l,m]=r.useState({current_password:"",new_password:"",new_password_confirmation:""}),[g,y]=r.useState(null),[v,N]=r.useState(null);r.useEffect(()=>{const s=new URLSearchParams(j.search).get("tab");h(s==="stats"||s==="password"?s:"profile")},[j.search]),r.useEffect(()=>{D(),t&&c({name:t.name,email:t.email,phone:t.phone||""})},[t]);const D=async()=>{try{const a=await u.getStats();k(a.data.data.stats)}catch{o.error("فشل تحميل الإحصائيات")}finally{P(!1)}},U=async a=>{a.preventDefault();try{const s=await u.update(n);w(s.data.data),localStorage.setItem("user",JSON.stringify(s.data.data)),o.success("تم تحديث الملف الشخصي بنجاح"),p(!1)}catch(s){o.error(s.response?.data?.message||"فشل تحديث الملف الشخصي")}},F=async a=>{if(a.preventDefault(),l.new_password!==l.new_password_confirmation){o.error("كلمات المرور غير متطابقة");return}try{await u.updatePassword(l),o.success("تم تحديث كلمة المرور بنجاح"),m({current_password:"",new_password:"",new_password_confirmation:""})}catch(s){o.error(s.response?.data?.message||"فشل تحديث كلمة المرور")}},L=a=>{const s=a.target.files[0];if(s){y(s);const f=new FileReader;f.onloadend=()=>{N(f.result)},f.readAsDataURL(s)}},T=async()=>{if(!g)return;const a=new FormData;a.append("avatar",g);try{const s=await u.updateAvatar(a);w(s.data.data),localStorage.setItem("user",JSON.stringify(s.data.data)),o.success("تم تحديث الصورة الشخصية بنجاح"),y(null),N(null)}catch{o.error("فشل تحديث الصورة الشخصية")}},b=a=>{h(a),S(`/profile?tab=${a}`)};return A?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-50 to-blue-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 font-semibold",children:"جاري التحميل..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 py-12",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"الملف الشخصي"}),e.jsx("p",{className:"text-gray-600",children:"إدارة معلوماتك الشخصية وإحصائياتك"})]}),e.jsx("div",{className:"flex justify-center mb-8",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-2 inline-flex gap-2",children:[e.jsxs("button",{onClick:()=>b("profile"),className:`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-300 ${i==="profile"?"bg-gradient-to-r from-blue-500 to-indigo-600 text-white shadow-lg":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(I,{className:"w-5 h-5"}),e.jsx("span",{children:"المعلومات الشخصية"})]}),e.jsxs("button",{onClick:()=>b("stats"),className:`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-300 ${i==="stats"?"bg-gradient-to-r from-green-500 to-emerald-600 text-white shadow-lg":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(M,{className:"w-5 h-5"}),e.jsx("span",{children:"الإحصائيات"})]}),e.jsxs("button",{onClick:()=>b("password"),className:`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all duration-300 ${i==="password"?"bg-gradient-to-r from-orange-500 to-red-600 text-white shadow-lg":"text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(C,{className:"w-5 h-5"}),e.jsx("span",{children:"تغيير كلمة المرور"})]})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto",children:[i==="profile"&&e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-8 md:p-12",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-32 h-32 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center text-white text-4xl font-bold shadow-xl",children:v?e.jsx("img",{src:v,alt:"Avatar",className:"w-full h-full rounded-full object-cover"}):t?.avatar?e.jsx("img",{src:t.avatar,alt:"Avatar",className:"w-full h-full rounded-full object-cover"}):t?.name?.charAt(0).toUpperCase()}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-white rounded-full p-3 shadow-lg cursor-pointer hover:bg-gray-100 transition-all",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600"}),e.jsx("input",{type:"file",accept:"image/*",onChange:L,className:"hidden"})]})]}),g&&e.jsx("button",{onClick:T,className:"mt-4 px-6 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:"حفظ الصورة"})]}),e.jsxs("form",{onSubmit:U,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"الاسم"}),e.jsx("input",{type:"text",value:n.name,onChange:a=>c({...n,name:a.target.value}),disabled:!x,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition-all disabled:bg-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"البريد الإلكتروني"}),e.jsx("input",{type:"email",value:n.email,onChange:a=>c({...n,email:a.target.value}),disabled:!x,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition-all disabled:bg-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"رقم الهاتف"}),e.jsx("input",{type:"tel",value:n.phone,onChange:a=>c({...n,phone:a.target.value}),disabled:!x,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition-all disabled:bg-gray-100"})]}),e.jsx("div",{className:"flex gap-4",children:x?e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:[e.jsx(q,{className:"w-5 h-5"}),"حفظ التغييرات"]}),e.jsxs("button",{type:"button",onClick:()=>{p(!1),c({name:t.name,email:t.email,phone:t.phone||""})},className:"flex items-center gap-2 px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition-all",children:[e.jsx(R,{className:"w-5 h-5"}),"إلغاء"]})]}):e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:[e.jsx(K,{className:"w-5 h-5"}),"تعديل المعلومات"]})})]})]}),i==="stats"&&d&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-3xl p-6 text-white shadow-xl transform hover:-translate-y-2 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(H,{className:"w-12 h-12 opacity-80"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-blue-100 text-sm",children:"إجمالي الشكاوى"}),e.jsx("p",{className:"text-4xl font-bold",children:d.total})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-yellow-500 to-orange-600 rounded-3xl p-6 text-white shadow-xl transform hover:-translate-y-2 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(O,{className:"w-12 h-12 opacity-80"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-yellow-100 text-sm",children:"قيد الانتظار"}),e.jsx("p",{className:"text-4xl font-bold",children:d.pending})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-indigo-600 rounded-3xl p-6 text-white shadow-xl transform hover:-translate-y-2 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(J,{className:"w-12 h-12 opacity-80"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-purple-100 text-sm",children:"قيد المعالجة"}),e.jsx("p",{className:"text-4xl font-bold",children:d.in_progress})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-500 to-emerald-600 rounded-3xl p-6 text-white shadow-xl transform hover:-translate-y-2 transition-all duration-300",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(B,{className:"w-12 h-12 opacity-80"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-green-100 text-sm",children:"تم الحل"}),e.jsx("p",{className:"text-4xl font-bold",children:d.resolved})]})]})})]})}),i==="password"&&e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl p-8 md:p-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:"تغيير كلمة المرور"}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"كلمة المرور الحالية"}),e.jsx("input",{type:"password",value:l.current_password,onChange:a=>m({...l,current_password:a.target.value}),required:!0,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"كلمة المرور الجديدة"}),e.jsx("input",{type:"password",value:l.new_password,onChange:a=>m({...l,new_password:a.target.value}),required:!0,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:outline-none transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-semibold mb-2",children:"تأكيد كلمة المرور الجديدة"}),e.jsx("input",{type:"password",value:l.new_password_confirmation,onChange:a=>m({...l,new_password_confirmation:a.target.value}),required:!0,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-orange-500 focus:outline-none transition-all"})]}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 text-white rounded-xl font-semibold hover:shadow-lg transition-all",children:[e.jsx(C,{className:"w-5 h-5"}),"تحديث كلمة المرور"]})]})]})]})]})})};export{ae as default};
